# –û—Ç—á–µ—Ç: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∑–æ–Ω –ø–æ–∏—Å–∫–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞

## üìã –û–±–∑–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π

**–î–∞—Ç–∞:** –î–µ–∫–∞–±—Ä—å 2024  
**–í–µ—Ä—Å–∏—è:** PRYTON v2  
**–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏:**
1. ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏ –∑–æ–Ω –ø–æ–∏—Å–∫–∞ –≤ –∞–¥–º–∏–Ω–∫—É –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∏–≥—Ä
2. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å —Å–æ–±—ã—Ç–∏—è–º–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ (timezone)

---

## üó∫Ô∏è –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∑–æ–Ω –ø–æ–∏—Å–∫–∞ –≤ –∞–¥–º–∏–Ω–∫—É

### –ß—Ç–æ –±—ã–ª–æ –∏–∑–º–µ–Ω–µ–Ω–æ

#### 1. –û–±–Ω–æ–≤–ª–µ–Ω –ø—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è –∏–≥—Ä –≤ –∞–¥–º–∏–Ω–∫–µ (`src/handlers/admin.py`)

**–ù–æ–≤—ã–µ —ç—Ç–∞–ø—ã —Å–æ–∑–¥–∞–Ω–∏—è –∏–≥—Ä—ã:**
- –®–∞–≥ 1/8: –í—ã–±–æ—Ä —Ä–∞–π–æ–Ω–∞
- –®–∞–≥ 2/8: –î–∞—Ç–∞ –∏–≥—Ä—ã  
- –®–∞–≥ 3/8: –í—Ä–µ–º—è –∏–≥—Ä—ã
- –®–∞–≥ 4/8: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
- –®–∞–≥ 5/8: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–¥–∏—Ç–µ–ª–µ–π
- –®–∞–≥ 6/8: –û–ø–∏—Å–∞–Ω–∏–µ –∏–≥—Ä—ã
- **üÜï –®–∞–≥ 7/8: –í—ã–±–æ—Ä –∏–≥—Ä–æ–≤–æ–π –∑–æ–Ω—ã** ‚Üê –ù–û–í–´–ô
- –®–∞–≥ 8/8: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ

#### 2. –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤—ã–±–æ—Ä–∞ –∑–æ–Ω

**–í–∞—Ä–∏–∞–Ω—Ç—ã –≤—ã–±–æ—Ä–∞ –∑–æ–Ω—ã:**
- **–°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–æ–Ω—ã —Ä–∞–π–æ–Ω–∞** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –∑–æ–Ω—ã —Å –∏—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏
- **–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∑–æ–Ω—É** - –ø–æ–ª–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è –∑–æ–Ω—ã –¥–ª—è –∏–≥—Ä—ã
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–æ–Ω–∞** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∑–æ–Ω—É —Ä–∞–π–æ–Ω–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

#### 3. –ü—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–π –∑–æ–Ω—ã

**–≠—Ç–∞–ø—ã —Å–æ–∑–¥–∞–Ω–∏—è –∑–æ–Ω—ã:**
1. –í–≤–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏—è –∑–æ–Ω—ã (–º–∏–Ω. 3 —Å–∏–º–≤–æ–ª–∞)
2. –í–≤–æ–¥ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç (—à–∏—Ä–æ—Ç–∞,–¥–æ–ª–≥–æ—Ç–∞)
3. –í–≤–æ–¥ —Ä–∞–¥–∏—É—Å–∞ (100-5000 –º–µ—Ç—Ä–æ–≤)
4. –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ

### –ù–æ–≤—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è ConversationHandler

```python
# –û—Å–Ω–æ–≤–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –∏–≥—Ä—ã
CREATE_DISTRICT, CREATE_DATE, CREATE_TIME, CREATE_MAX_PARTICIPANTS, 
CREATE_MAX_DRIVERS, CREATE_DESCRIPTION, CREATE_ZONE, CREATE_CONFIRM = range(8)

# –°–æ—Å—Ç–æ—è–Ω–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–æ–Ω
CREATE_ZONE_NAME, CREATE_ZONE_COORDINATES, 
CREATE_ZONE_RADIUS, CREATE_ZONE_CONFIRM = range(25, 29)
```

### –ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

| –§—É–Ω–∫—Ü–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|---------|------------|
| `process_zone_selection()` | –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞ –∑–æ–Ω—ã |
| `process_zone_name()` | –í–≤–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏—è –Ω–æ–≤–æ–π –∑–æ–Ω—ã |
| `process_zone_coordinates()` | –í–≤–æ–¥ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç —Ü–µ–Ω—Ç—Ä–∞ |
| `process_zone_radius()` | –í–≤–æ–¥ —Ä–∞–¥–∏—É—Å–∞ –∑–æ–Ω—ã |
| `process_zone_confirmation()` | –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è –∑–æ–Ω—ã |
| `show_final_confirmation()` | –ò—Ç–æ–≥–æ–≤–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∏–≥—Ä—ã |

---

## ‚è∞ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞

### –ü—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ —Ä–µ—à–µ–Ω—ã

#### 1. **–ü—Ä–æ–±–ª–µ–º–∞ —Å timezone**
- **–ë—ã–ª–æ:** DateTrigger —Ä–∞–±–æ—Ç–∞–ª –±–µ–∑ —É—á–µ—Ç–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –∑–æ–Ω—ã
- **–°—Ç–∞–ª–æ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ Moscow timezone (Europe/Moscow)

#### 2. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–∏**
- **–ë—ã–ª–æ:** –°–æ–±—ã—Ç–∏—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–ª–∏—Å—å –≤ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –≤—Ä–µ–º—è
- **–°—Ç–∞–ª–æ:** –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏ —Å timezone

#### 3. **–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è**
- **–ë—ã–ª–æ:** –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –≤—ã–∑—ã–≤–∞–ª–∏ –æ—à–∏–±–∫–∏
- **–°—Ç–∞–ª–æ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ –ø—Ä–æ–ø—É—Å–∫ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã—Ö

### –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `src/services/enhanced_scheduler_service.py`

#### 1. –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ timezone
```python
import pytz

# –û–ø—Ä–µ–¥–µ–ª—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é –∑–æ–Ω—É (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –º–æ—Å–∫–æ–≤—Å–∫–æ–µ –≤—Ä–µ–º—è)
DEFAULT_TIMEZONE = pytz.timezone(os.getenv("TIMEZONE", "Europe/Moscow"))

class EnhancedSchedulerService:
    def __init__(self, application: Application):
        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –≤—Ä–µ–º–µ–Ω–Ω–æ–π –∑–æ–Ω–æ–π
        self.scheduler = AsyncIOScheduler(timezone=DEFAULT_TIMEZONE)
```

#### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –≤ —Å–æ–±—ã—Ç–∏—è—Ö
```python
def _schedule_event_from_db(self, event: ScheduledEvent) -> bool:
    # –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –≤—Ä–µ–º—è —Å–æ–±—ã—Ç–∏—è –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –≤—Ä–µ–º–µ–Ω–Ω—É—é –∑–æ–Ω—É
    scheduled_time = event.scheduled_at
    if scheduled_time.tzinfo is None:
        scheduled_time = DEFAULT_TIMEZONE.localize(scheduled_time)
    elif scheduled_time.tzinfo != DEFAULT_TIMEZONE:
        scheduled_time = scheduled_time.astimezone(DEFAULT_TIMEZONE)
    
    # –ü–ª–∞–Ω–∏—Ä—É–µ–º —Å–æ–±—ã—Ç–∏–µ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –≤—Ä–µ–º–µ–Ω–µ–º
    self.scheduler.add_job(
        func,
        trigger=DateTrigger(run_date=scheduled_time),
        args=args,
        id=event.job_id,
        replace_existing=True
    )
```

#### 3. –£–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π
```python
def schedule_game_reminders(self, game_id: int):
    # –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –≤—Ä–µ–º—è –∏–≥—Ä—ã –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –≤—Ä–µ–º–µ–Ω–Ω—É—é –∑–æ–Ω—É
    game_time = game.scheduled_at
    if game_time.tzinfo is None:
        game_time = DEFAULT_TIMEZONE.localize(game_time)
    
    # –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –≤—Ä–µ–º–µ–Ω–Ω–æ–π –∑–æ–Ω–µ
    current_time = datetime.now(DEFAULT_TIMEZONE)
    
    # –ü–ª–∞–Ω–∏—Ä—É–µ–º —Ç–æ–ª—å–∫–æ –±—É–¥—É—â–∏–µ —Å–æ–±—ã—Ç–∏—è
    for reminder_minutes in self.reminder_times:
        reminder_time = game_time - timedelta(minutes=reminder_minutes)
        
        if reminder_time > current_time:
            # –ü–ª–∞–Ω–∏—Ä—É–µ–º –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

**–§–∞–π–ª:** `tests/test_scheduler_timezone_fix.py`

**–¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:**
1. ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π —Å timezone
2. ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –∏–∑ –ë–î
3. ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–æ–±—ã—Ç–∏—è—Ö
4. ‚úÖ –û—Ç–º–µ–Ω–∞ —Å–æ–±—ã—Ç–∏–π

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

| –¢–µ—Å—Ç | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|--------|----------|
| Timezone Support | ‚úÖ | –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å Moscow timezone |
| Event Restoration | ‚úÖ | –°–æ–±—ã—Ç–∏—è –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –∏–∑ –ë–î –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ |
| Time Conversion | ‚úÖ | –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏ |
| Overdue Events | ‚úÖ | –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è |

---

## üìà –£–ª—É—á—à–µ–Ω–∏—è –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

### –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –≤—ã–±–æ—Ä–∞ –∑–æ–Ω

```
üó∫Ô∏è –®–∞–≥ 7/8: –í—ã–±–æ—Ä –∏–≥—Ä–æ–≤–æ–π –∑–æ–Ω—ã

üìç –†–∞–π–æ–Ω: –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π

–î–æ—Å—Ç—É–ø–Ω—ã–µ –∑–æ–Ω—ã —Ä–∞–π–æ–Ω–∞:
‚Ä¢ ‚úÖüåü –ü–∞—Ä–∫ –ì–æ—Ä—å–∫–æ–≥–æ
  üìç –¶–µ–Ω—Ç—Ä: 55.7314, 37.6016
  üìè –†–∞–¥–∏—É—Å: 800–º | üìê –ü–ª–æ—â–∞–¥—å: 2.01 –∫–º¬≤
  üí¨ –ì–ª–∞–≤–Ω–∞—è –∑–æ–Ω–∞ –ø–∞—Ä–∫–∞

‚Ä¢ ‚úÖ –¢–æ—Ä–≥–æ–≤—ã–π —Ü–µ–Ω—Ç—Ä
  üìç –¶–µ–Ω—Ç—Ä: 55.7289, 37.6055  
  üìè –†–∞–¥–∏—É—Å: 500–º | üìê –ü–ª–æ—â–∞–¥—å: 0.79 –∫–º¬≤

–í–∞—Ä–∏–∞–Ω—Ç—ã:
‚Ä¢ –í—ã–±–µ—Ä–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∑–æ–Ω—É –∏–∑ —Å–ø–∏—Å–∫–∞
‚Ä¢ –ù–∞–∂–º–∏—Ç–µ 'üÜï –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∑–æ–Ω—É' –¥–ª—è –∏–≥—Ä—ã
‚Ä¢ –ù–∞–∂–º–∏—Ç–µ '‚öôÔ∏è –ë–µ–∑ –∑–æ–Ω—ã' (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–æ–Ω—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

üåü - –∑–æ–Ω–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, ‚úÖ - –∞–∫—Ç–∏–≤–Ω–∞—è, ‚ùå - –Ω–µ–∞–∫—Ç–∏–≤–Ω–∞—è
```

### –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –Ω–æ–≤–æ–π –∑–æ–Ω—ã

```
üó∫Ô∏è –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –Ω–æ–≤–æ–π –∑–æ–Ω—ã

üìç –ù–∞–∑–≤–∞–Ω–∏–µ: –¶–µ–Ω—Ç—Ä –ø–∞—Ä–∫–∞
üéØ –¶–µ–Ω—Ç—Ä: 55.731400, 37.601600
üìè –†–∞–¥–∏—É—Å: 600–º
üìê –ü–ª–æ—â–∞–¥—å: 1.13 –∫–º¬≤

–í—Å—ë –≤–µ—Ä–Ω–æ?
```

---

## üöÄ –ó–∞–ø—É—Å–∫ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

```bash
# –¢–µ—Å—Ç –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ —Å timezone
python tests/test_scheduler_timezone_fix.py

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞
python check_scheduler_status.py

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ (–≤ –±–æ—Ç–µ)
/scheduler_monitor
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∑–æ–Ω

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞: `python main.py`
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É `/admin`
3. –í—ã–±–µ—Ä–∏—Ç–µ "üéÆ –°–æ–∑–¥–∞—Ç—å –∏–≥—Ä—É"
4. –ü—Ä–æ–π–¥–∏—Ç–µ –¥–æ —ç—Ç–∞–ø–∞ –≤—ã–±–æ—Ä–∞ –∑–æ–Ω—ã
5. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã:
   - –í—ã–±–æ—Ä —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∑–æ–Ω—ã
   - –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∑–æ–Ω—ã
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–æ–Ω–∞

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

| –§–∞–π–ª | –°—Ç—Ä–æ–∫ –∏–∑–º–µ–Ω–µ–Ω–æ | –¢–∏–ø –∏–∑–º–µ–Ω–µ–Ω–∏–π |
|------|----------------|---------------|
| `src/handlers/admin.py` | +400 | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∑–æ–Ω –≤ —Å–æ–∑–¥–∞–Ω–∏–µ –∏–≥—Ä |
| `src/services/enhanced_scheduler_service.py` | +80 | –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ timezone |
| `tests/test_scheduler_timezone_fix.py` | +180 | –ù–æ–≤—ã–π —Ç–µ—Å—Ç |

### –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üó∫Ô∏è **–ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∑–æ–Ω** –≤ –ø—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è –∏–≥—Ä
- ‚è∞ **–°—Ç–∞–±–∏–ª—å–Ω—ã–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫** —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π timezone
- üß™ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
- üìä **–£–ª—É—á—à–µ–Ω–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞** —Å–æ–±—ã—Ç–∏–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞

---

## ‚úÖ –ò—Ç–æ–≥–∏

### –ß—Ç–æ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–æ

1. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∑–æ–Ω –ø–æ–∏—Å–∫–∞ –≤ –∞–¥–º–∏–Ω–∫—É:**
   - –ê–¥–º–∏–Ω—ã –º–æ–≥—É—Ç –≤—ã–±–∏—Ä–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–æ–Ω—ã
   - –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö –∑–æ–Ω –¥–ª—è –∏–≥—Ä—ã
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∑–æ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
   - –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–æ–Ω–∞—Ö –ø—Ä–∏ –≤—ã–±–æ—Ä–µ

2. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞:**
   - –†–µ—à–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å timezone (Moscow time)
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω DateTrigger –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è
   - –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

3. **–£–ª—É—á—à–µ–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç:**
   - –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –≤—ã–±–æ—Ä–∞ –∑–æ–Ω
   - –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö –∑–æ–Ω
   - –ù–∞–¥–µ–∂–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É

- ‚úÖ –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã
- ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–°—Ç–∞—Ç—É—Å:** üöÄ **–ì–û–¢–û–í–û –ö –†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–Æ** 